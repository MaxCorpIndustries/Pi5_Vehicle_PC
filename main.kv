#:import SlideTransition kivy.uix.screenmanager.SlideTransition

#:kivy 2.2.0

<MainLayout>:
    orientation: "vertical"

    ScreenManager:
        id: screen_manager
		transition: SlideTransition(duration=0.25)
		
        Screen:
			name: "cameras"
            BoxLayout:
                orientation: "vertical"
                spacing: 10
                padding: 10

                Label:
                    text: "Cameras"
                    font_size: 22
                    size_hint_y: None
                    height: '25dp'
                    text_size: self.size
                    halign: 'left'
                    valign: 'middle'

                Widget:
                    size_hint_y: None
                    height: 2
                    canvas:
                        Color:
                            rgb: 1, 1, 1
                        Rectangle:
                            pos: self.pos
                            size: self.size
                BoxLayout:
                    orientation: "horizontal"
                    spacing: 5
                    padding: 5
                    size_hint_y: 1
                    
                    KivyCamera:
                        id: camera_view
                        allow_stretch: True
                        keep_ratio: True
                        size_hint_y: 1


                
                BoxLayout:
                    orientation: "horizontal"
                    spacing: 0
                    padding: 0
                    size_hint_y: 0.15
                    
                    RoundedButton:
                        icon_source: 'cameras.png'
                        on_release: app.on_start()
                        
                    RoundedButton:
                        icon_source: 'stop.png'
                        on_release: app.stopcamPreview()
                        
                Widget:  # spacer
                    size_hint_y: 0.15


                Widget:
                    size_hint_y: None
                    height: 2
                    canvas:
                        Color:
                            rgb: 1, 1, 1
                        Rectangle:
                            pos: self.pos
                            size: self.size

        Screen:
            name: "settings"
            BoxLayout:
                orientation: "vertical"
                spacing: 10
                padding: 10

                Label:
                    text: "Settings"
                    font_size: 22
                    size_hint_y: None
                    height: '25dp'
                    text_size: self.size
                    halign: 'left'
                    valign: 'middle'

                Widget:
                    size_hint_y: None
                    height: 2
                    canvas:
                        Color:
                            rgb: 1, 1, 1
                        Rectangle:
                            pos: self.pos
                            size: self.size

                Widget:  # spacer

                Widget:
                    size_hint_y: None
                    height: 2
                    canvas:
                        Color:
                            rgb: 1, 1, 1
                        Rectangle:
                            pos: self.pos
                            size: self.size

        Screen:
            name: "about"
            BoxLayout:
                orientation: "vertical"
                spacing: 10
                padding: 10

                Label:
                    text: "About"
                    font_size: 22
                    size_hint_y: None
                    height: '25dp'
                    text_size: self.size
                    halign: 'left'
                    valign: 'middle'

                Widget:
                    size_hint_y: None
                    height: 2
                    canvas:
                        Color:
                            rgb: 1, 1, 1
                        Rectangle:
                            pos: self.pos
                            size: self.size

                Widget:  # spacer

                Widget:
                    size_hint_y: None
                    height: 2
                    canvas:
                        Color:
                            rgb: 1, 1, 1
                        Rectangle:
                            pos: self.pos
                            size: self.size
    BoxLayout:
        size_hint_y: 0.15
        spacing: 30  # 20px horizontal spacing, 0px vertical
        padding: 45, 2 # 10px padding on left/right, 0px top/bottom

        RoundedButton:
			icon_source: 'cameras.png'
            on_release: app.switch_screen("cameras")

        RoundedButton:
			icon_source: 'setting.png'
            on_release: app.switch_screen("settings")

        RoundedButton:
			icon_source: 'car.png'
            on_release: app.switch_screen("about")

        RoundedButton:
			icon_source: 'testsquare.png'
            on_release: app.switch_screen("about")
			

        RoundedButton:
            text: "Ã—"
			bold: True
            font_size: 64
			halign: 'center'
			valign: 'center'
            size_hint_x: 0.5
            on_release: app.stop()


# ----------------- CUSTOM ROUNDED BUTTON -----------------
<RoundedButton@Button>:
    text: ""
    radius: [30]  # default radius
    #width: '80dp'
    size_hint_x: 1
    
	color: 1, 0.9, 0.9, 1
	normal_color: 0, 0, 0, 1
	down_color: 0.8, 0.8, 0.8, 1
	
	icon_source: ""           # path to icon image
	icon_color: 1, 1, 1, 1  # RGBA color to tint icon

    background_color: 0, 0, 0, 0
    background_normal: ""

    canvas.before:
        Color:
            rgba: self.state == "down" and self.down_color or self.normal_color
        RoundedRectangle:
            pos: self.pos
            size: self.size
            radius: self.radius if self.radius else [14]  # safe fallback

    BoxLayout:
        orientation: "horizontal"
        padding: 0
        spacing: 0
        center_y: self.parent.center_y
        center_x: self.parent.center_x
		
        # Icon image
        Image:
            source: root.icon_source if root.icon_source else ""  # show nothing if no icon
            size_hint: None, None
            size: self.size
            allow_stretch: True
            opacity: 1 if root.icon_source else 0
			color: root.icon_color if root.icon_color else (1, 1, 1, 1)
            
<Label>:
    font_name: "fonts/Roboto-Regular.ttf"
    
